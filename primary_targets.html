<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Primary Challenge Index - Target List</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Courier+Prime:wght@400;700&family=Special+Elite&family=IBM+Plex+Mono:wght@400;600&display=swap" rel="stylesheet">
    <link rel="icon" type="image/png" href="/favicon.png">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Courier Prime', monospace; 
            background: #0a0a0a; 
            color: #d4d4d4; 
            line-height: 1.6;
        }
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        
        .header { 
            background: linear-gradient(135deg, #1a1a1a 0%, #0a0a0a 100%);
            padding: 50px; 
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.8);
            border-top: 4px solid #d4af37;
            border-bottom: 4px solid #d4af37;
            text-align: center;
        }
        .header h1 { 
            font-family: 'Special Elite', monospace;
            font-size: 3.5rem; 
            margin-bottom: 15px; 
            color: #d4af37;
            text-transform: uppercase;
            letter-spacing: 3px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
        }
        .header .subtitle { 
            font-size: 1.4rem; 
            color: #a8a8a8;
            font-style: italic;
            letter-spacing: 1px;
        }
        
        .back-link {
            display: inline-block;
            margin: 20px 0;
            padding: 12px 24px;
            background: transparent;
            color: #d4af37;
            text-decoration: none;
            border: 2px solid #d4af37;
            font-size: 1rem;
            transition: all 0.3s;
        }
        .back-link:hover {
            background: rgba(212, 175, 55, 0.1);
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.3);
        }
        
        .alert-box {
            background: linear-gradient(135deg, #1a0000 0%, #0a0000 100%);
            padding: 30px;
            margin-bottom: 30px;
            border: 3px solid #b22222;
            border-left: 8px solid #b22222;
            box-shadow: 0 4px 20px rgba(178, 34, 34, 0.2);
        }
        .alert-box h2 {
            font-family: 'Special Elite', monospace;
            font-size: 2rem;
            color: #d4af37;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        .alert-box p {
            font-size: 1.1rem;
            color: #c4c4c4;
            line-height: 1.8;
        }
        
        .section { 
            background: #141414; 
            padding: 35px; 
            margin-bottom: 25px; 
            box-shadow: 0 4px 20px rgba(0,0,0,0.5);
            border: 1px solid #333;
        }
        .section h2 { 
            font-family: 'Special Elite', monospace;
            font-size: 2rem; 
            margin-bottom: 25px; 
            color: #d4af37;
            text-transform: uppercase;
            letter-spacing: 2px;
            border-bottom: 2px solid #d4af37;
            padding-bottom: 10px;
        }
        
        table { 
            width: 100%; 
            border-collapse: collapse; 
            font-family: 'IBM Plex Mono', monospace;
            margin-top: 20px;
        }
        th { 
            background: #0a0a0a; 
            padding: 15px; 
            text-align: left; 
            font-weight: 600; 
            border-bottom: 3px solid #d4af37;
            color: #d4af37;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 0.95rem;
        }
        td { 
            padding: 15px; 
            border-bottom: 1px solid #333;
            color: #c4c4c4;
        }
        tr:hover { background: #1a1a1a; }
        
        .rank {
            font-size: 1.5rem;
            font-weight: 700;
            color: #d4af37;
        }
        .betrayal-count {
            font-size: 1.3rem;
            font-weight: 700;
            color: #b22222;
        }
        
        .filter-bar {
            margin: 20px 0;
            padding: 15px;
            background: #1a1a1a;
            border: 1px solid #333;
        }
        .filter-bar label {
            color: #d4af37;
            margin-right: 10px;
            font-weight: 600;
        }
        .filter-bar input {
            padding: 8px;
            background: #0a0a0a;
            border: 1px solid #d4af37;
            color: #d4d4d4;
            font-family: 'Courier Prime', monospace;
            margin-right: 15px;
        }
        
        @media (max-width: 768px) {
            .header h1 { font-size: 2rem; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Primary Challenge Index</h1>
            <p class="subtitle">Most Vulnerable Betrayers<br>Targets for Progressive Challengers</p>
        </div>
        
        <a href="index.html" class="back-link">‚Üê Back to Rotating Villains Tracker</a>
        
        <div class="alert-box">
            <h2>üéØ Accountability Through Primaries</h2>
            <p>
                These are current members of Congress who have betrayed their voters most frequently. 
                High betrayal counts in safe Democratic districts indicate members who could be challenged 
                by progressive primary candidates. This data is for activist organizing and voter education.
            </p>
        </div>
        
        <div class="section">
            <h2>üìä Top Primary Targets (Current Members)</h2>
            
            <div class="filter-bar">
                <label>Filter by State:</label>
                <input type="text" id="stateFilter" placeholder="e.g. CA, TX, NY" onkeyup="filterTable()">
                <label>Min Betrayals:</label>
                <input type="number" id="minBetrayal" placeholder="10" value="10" onchange="filterTable()">
            </div>
            
            <table>
                <thead>
                    <tr>
                        <th>Rank</th>
                        <th>Member</th>
                        <th>State</th>
                        <th>Total Betrayals</th>
                        <th>Voted with GOP</th>
                        <th>Conveniently Absent</th>
                    </tr>
                </thead>
                <tbody id="targetsTable"></tbody>
            </table>
        </div>
    </div>
    
    <script>
        let allTargets = [];
        
        fetch('current_villains.json')
            .then(res => res.json())
            .then(data => {
                allTargets = data.current_villains;
                renderTable(allTargets);
            });
        
        function filterTable() {
            const stateFilter = document.getElementById('stateFilter').value.toUpperCase();
            const minBetrayal = parseInt(document.getElementById('minBetrayal').value) || 0;
            
            const filtered = allTargets.filter(v => {
                const total = v.voted_with_gop + v.absent;
                const matchesState = !stateFilter || v.state.toUpperCase().includes(stateFilter);
                const meetsMin = total >= minBetrayal;
                return matchesState && meetsMin;
            });
            
            renderTable(filtered);
        }
        
        function renderTable(targets) {
            const html = targets.map((v, i) => {
                const total = v.voted_with_gop + v.absent;
                return `
                    <tr>
                        <td class="rank">${i + 1}</td>
                        <td><strong>${v.name}</strong></td>
                        <td>${v.state}</td>
                        <td class="betrayal-count">${total}</td>
                        <td style="color: #b22222;">${v.voted_with_gop}</td>
                        <td style="color: #d4af37;">${v.absent}</td>
                    </tr>
                `;
            }).join('');
            
            document.getElementById('targetsTable').innerHTML = html || 
                '<tr><td colspan="6" style="text-align: center; padding: 40px; color: #888;">No members match your filters</td></tr>';
        }
    </script>
</body>
</html>
